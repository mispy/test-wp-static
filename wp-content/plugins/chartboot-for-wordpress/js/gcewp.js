var GCEWP=(function(){var t=new Array();var f;var c;var a="BarChart";var e;var j;var d;var n;var k;var v=new google.visualization.DataTable();v.addColumn("string","Year");v.addColumn("number","Sales");v.addColumn("number","Expenses");v.addRows([["2004",1000,400],["2005",1170,460],["2006",660,1120],["2007",1030,540]]);var l=800;var q=400;var p=1;var i=1;c={title:"Company Performance",isStacked:false};function g(){var x="";var w=["A","B","C","D","E","F","0","1","2","3","4","5","6","7","8","9"];for(var h=0;h<4;h++){x+=w[Math.floor(Math.random()*16)]}return x}function m(){var x=g();var y="";y+="\n";y+="[chartboot ";y+="version= '3.0' ";y+="code= '"+x+"' ";if(jQuery("#brdcb").is(":checked")){y+="border= '1' "}else{y+="border= '0' "}y+="width= '"+jQuery("#ws").val()+"' ";y+="height= '"+jQuery("#hs").val()+"' ";if(jQuery("#attribution").is(":checked")){y+="attribution= '1' "}else{y+="attribution= '0' "}var h=f.toJSON().replace("visualization","visualization"+x);h=h.replace(/\[/g,"xxx00xxx");h=h.replace(/\]/g,"xxx01xxx");h=h.replace(/\'/g,"xxx02xxx");h=h.replace(/\&/g,"xxx03xxx");y+="jsondesc= '"+h+"' ";y+="]";y+="\n";var w=/\\u([\d\w]{4})/gi;y=y.replace(w,function(z,A){return String.fromCharCode(parseInt(A,16))});y=unescape(y);return y}function s(){e=m()}function r(h){return(h.match(/CBViZ/g)).length}function u(){var w="";var h=jQuery("#content",window.parent.document).val();w+=(h.match(/function drawChart/g)).length;jQuery("#dbg").text(w)}function b(){var h=jQuery("#haslabels").is(":checked");n=new Array();for(var w=0;w<d[0].length;w++){if(h){n[w]=d[0][w]}else{n[w]="Col#"+w}}k=new Array();k[0]="string";for(var w=1;w<d[0].length;w++){k[w]="number"}}function o(){var h="";h+="<table width='100%' class='table'>";h+="<tr>";h+="<td>Label and Type</td>";h+="</tr>";for(var w=0;w<n.length;w++){h+="<tr>";h+="<td>"+n[w]+"</br>";h+="<SELECT class='span2' id='tp"+w+"'>";if(k[w]=="string"){h+="<OPTION value='string' SELECTED>string</OPTION>"}else{h+="<OPTION value='string'>string</OPTION>"}if(k[w]=="number"){h+="<OPTION value='number' SELECTED>number</OPTION>"}else{h+="<OPTION value='number'>number</OPTION>"}if(k[w]=="date"){h+="<OPTION value='date' SELECTED>date</OPTION>"}else{h+="<OPTION value='date'>date</OPTION>"}h+="</SELECT>";h+="</tr>"}h+="</table>";return h}return{init:function(){f=new google.visualization.ChartWrapper({dataTable:v,containerId:"visualization",chartType:a});f.setOptions(c);f.draw();s()},importData:function(){j=jQuery("#inp").val();var w=jQuery("#inp").val();w=w.replace(/^\n/g,"");w=w.replace(/\njQuery/g,"");d=w.split(/[\n]/);for(var h=0;h<d.length;h++){d[h]=d[h].split(/[\t]/)}b();document.getElementById("ds").innerHTML=o();GCEWP.setTypes()},setTypes:function(){for(var B=0;B<k.length;B++){k[B]=jQuery("#tp"+B).val()}v.removeColumns(0,v.getNumberOfColumns());v.removeRows(0,v.getNumberOfRows());for(var w=0;w<n.length;w++){v.addColumn(k[w],n[w])}var C;var D=d.length-1;var z=jQuery("#haslabels").is(":checked");if(z){C=1}else{C=0}var A=D-C;v.addRows(A);for(var y=0;y<A;y++){for(var x=0;x<k.length;x++){if(k[x]=="string"){v.setCell(y,x,d[y+C][x])}if(k[x]=="number"){v.setCell(y,x,parseFloat(d[y+C][x]))}if(k[x]=="date"){v.setCell(y,x,Date.parse(d[y+C][x]))}}}GCEWP.init()},openEditor:function(){var h=new google.visualization.ChartEditor();google.visualization.events.addListener(h,"ok",function(){f=h.getChartWrapper();f.draw(document.getElementById("visualization"));c=f.getOptions();a=f.getChartType();s()});h.openDialog(f,{width:100})},sendCode:function(){var w=e;var z=jQuery("#content",window.parent.document).val();var A=z+w;var x=jQuery("#content-html",window.parent.document);var C=jQuery("#content-tmce",window.parent.document);var y=jQuery("#content",window.parent.document);var B=y.css("display")=="none";if(B){window.parent.switchEditors.switchto(x[0]);jQuery("#content",window.parent.document).val(A)}if(B){window.parent.switchEditors.switchto(C[0])}jQuery("#content",window.parent.document).val(A);window.parent.jQuery("#aaape").remove();return false},setStyle:function(){l=jQuery("#ws").val();jQuery("#visualization").width(jQuery("#ws").val());jQuery("#brd").width(jQuery("#ws").val());q=jQuery("#hs").val()-25;jQuery("#visualization").height(jQuery("#hs").val()-25);jQuery("#brd").height(jQuery("#hs").val());var h=jQuery("#brdcb").is(":checked");if(h){jQuery("#brd").css("border","1px darkgray solid");p=1}else{jQuery("#brd").css("border","0px darkgray solid");p=0}var h=jQuery("#attribution").is(":checked");if(h){jQuery("#attr").css("display","block");i=1}else{jQuery("#attr").css("display","none");i=0}GCEWP.init();return false}}})();google.setOnLoadCallback(GCEWP.init());